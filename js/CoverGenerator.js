// Generated by CoffeeScript 1.9.3
(function() {
  var CoverGenerator, cfs, constants, exec, log, path;

  cfs = require('./cfs');

  constants = require('./constants');

  exec = require('./exec');

  log = require('./log');

  path = require('path');

  CoverGenerator = (function() {
    function CoverGenerator(rootDir, dir, images, force) {
      this.rootDir = rootDir;
      this.dir = dir;
      this.images = images;
      this.force = force;
    }

    CoverGenerator.prototype.generateImage = function(src, dst) {
      if (this.force.cover || cfs.newer(src, dst)) {
        log.verbose("Generating thumbnail: " + src + " -> " + dst);
        return exec('convert', ['-resize', constants.COVER_WIDTH + "x", src, dst], this.dir);
      }
    };

    CoverGenerator.prototype.generate = function() {
      if (this.images.length > 0) {
        this.generateImage(path.resolve(this.dir, this.images[0]), cfs.join(this.dir, constants.COVER_FILENAME));
        return this.generateImage(path.resolve(this.dir, this.images[this.images.length - 1]), cfs.join(this.dir, constants.RECENT_COVER_FILENAME));
      }
    };

    return CoverGenerator;

  })();

  module.exports = CoverGenerator;

}).call(this);
